from fastapi import FastAPI
from fastapi.responses import RedirectResponse

from database import engine

import summer_practice.products.models

from summer_practice.products.routes import router_products, router_blacklist, router_stores
from summer_practice.tasks.routes import router_task

summer_practice.products.models.Base.metadata.create_all(bind=engine)


description = """
## Swagger UI –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ö–µ–º—ã –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö, —Ç–∞–º, –≥–¥–µ –∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ, –Ω–µ –∑–Ω–∞—é –ø–æ—á–µ–º—É. 
### –ü–æ—ç—Ç–æ–º—É —Å–æ–≤–µ—Ç—É—é –æ—Ç–∫—Ä—ã—Ç—å '/redoc' –∏ –≤—Ä—É—á–Ω—É—é –∏–∑–º–µ–Ω—è—Ç—å —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
**–í ReDoc –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å—Ö–µ–º—É –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ—ë, –∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å, 
–Ω–µ –ø–æ–ª—å–∑—É—è—Å—å –Ω–∏–∫–∞–∫–∏–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –º–æ–∂–Ω–æ –≤ Swagger UI (/docs)** 

***FindTheBestThing API*** –ø–æ–º–æ–∂–µ—Ç –í–∞–º —Å –ø–æ–∏—Å–∫–æ–º –Ω–∞–∏–ª—É—á—à–µ–π —Ü–µ–Ω—ã —Å —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤! üöÄ

## –¢–æ–≤–∞—Ä—ã


**–í—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, –µ–≥–æ —Ü–µ–Ω—É, –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ.**

–í —Ç–æ–º —á–∏—Å–ª–µ:
* ~~–ê–Ω–∞–ª–∏—Ç–∏–∫—É —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –º–∞–≥–∞–∑–∏–Ω—É (_not implemented_).~~

**Upd.** –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–∞–≥–∞–∑–∏–Ω–æ–≤ –∏ –∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º–æ–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å.

–ó–∞–ø—Ä–æ—Å—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ö–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤, –∏—Ö –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ä–∞—Å–∫—Ä—ã–≤—à–µ–º—Å—è –∑–∞–ø—Ä–æ—Å–µ - schemas.
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ —Ç–∞–∫–∞—è –≥–∏–±–∫–∞—è, –∫–∞–∫—É—é —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –≤–∏–¥–µ—Ç—å, –ø–æ—ç—Ç–æ–º—É —ç—Ç–∏ —Å—Ö–µ–º—ã –Ω–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å. –û—Å—Ç–∞—ë—Ç—Å—è –ª–∏—à—å –ø–∏—Å–∞—Ç—å –≤—Ä—É—á–Ω—É—é.
–ù–æ —è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞—é—Å—å –æ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏/—Å—Ö–µ–º—ã. –ù–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ)

"""


app = FastAPI(
    title="FindTheBestThing",
    description=description,
    summary="–õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ª—É—á—à–∏—Ö!",
    version="0.0.1",
)


@app.get("/", name='redirect',
         description="**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ —Å –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –ø—É—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**")
def read_root():
    return RedirectResponse('/docs')


app.include_router(router_task)
app.include_router(router_stores)
app.include_router(router_products)
app.include_router(router_blacklist)

if __name__ == '__main__':
    import uvicorn
    uvicorn.run(app, host='0.0.0.0', port=8080)
